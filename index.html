<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diálogo entre Gato y Niña</title>
    <style>
        #newPage, #finalPage {
            display: none;
            text-align: center;
            padding: 20px;
            font-size: 24px;
        }

        #continueButton {
            padding: 10px;
            font-size: 18px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            left: 45%;
            top: 10px;
        }

        #recop {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>
<body style="background-image: url('https://rony260519.github.io/silver-dollop/startetc.jpeg');"> 
    
    <div id="firstLine">
        <img id="gatoImgStart" src="https://rony260519.github.io/silver-dollop/capcat.png" alt="Gato" class="gato-imgs img-adj">
        <div class="options" id="options" style="display: none;">
            <button id="option-yes" class="butt-opt" style="background-color: rgb(180, 242, 87);" onclick="joinMission(true)">Sí</button>
            <button id="option-no" class="butt-opt" style="background-color: rgb(243, 84, 70);" onclick="joinMission(false)">No</button>
        </div>
        
        <div class="chat-bubble" id="gatoBubbleStart">
            <div class="text" id="gatoTextStart"></div>
        </div>
    </div>
    
    <div id="game" style="display: none;">
        <img id="gatoImgInside" src="https://rony260519.github.io/silver-dollop/catinside.png" alt="Gato" class="gato-imgs img-adj" style="top: 24.5%;">
        <div class="chat-bubble" id="gatoBubbleInside">
            <div class="text" id="gatoTextinside"></div>
        </div>
    
        <div id="codeScreen"></div>
    </div>

    <div style="display: none;" id="dialoguePlanet">
        <div id="dialogue">
            <img id="gatoImg" src="https://rony260519.github.io/silver-dollop/capcat.png" alt="Gato" class="gato-imgs img-adj">
            <img id="ninaImg" src="https://rony260519.github.io/silver-dollop/dany1.png" alt="Niña" class="nina-imgs img-adj">
            
            <div class="chat-bubble" id="gatoBubble" >
                <div class="text" id="gatoText"></div>
            </div>
            <div class="chat-bubble" id="ninaBubble" >
                <div class="text" id="ninaText"></div>
            </div>
        </div>
    
        <div id="newPage">
            <img id="gatoImgNew" src="https://rony260519.github.io/silver-dollop/capcat.png" alt="Gato" class="gato-imgs img-adj">
            <div class="chat-bubble" id="gatoBubbleNew">
                <div class="text" id="gatoTextNew"></div>
            </div>
        </div>
    
        <div id="finalPage">
            <img id="gatoImgFinal" src="https://rony260519.github.io/silver-dollop/capcat.png" alt="Gato" class="gato-imgs img-adj">
            <img id="ninaImgFinal" src="https://rony260519.github.io/silver-dollop/dany1.png" alt="Niña" class="nina-imgs img-adj">
            <div class="chat-bubble" id="finalBubble">
                <div class="text" id="finalText"></div>
                <div class="contacts" id="contact" style="display: none;">
                    <a class="link-c" href="" target="_blank">
                        <img class="img-c" src="https://seekicon.com/free-icon-download/github-square_4.svg" alt="github icon" title="github profile">
                    </a>
                    <a class="link-c" href="mailto:danielavegapena115@gmail.com" target="_blank">
                        <img class="img-c" src="https://clipartcraft.com/images/gmail-logo-round-3.png" alt="Gmail icon" title="Gmail">
                    </a>
                    <a class="link-c" href="https://www.linkedin.com/in/daniela-vega-pena-971221288?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank">
                        <img class="img-c" src="https://cdn.freebiesupply.com/logos/large/2x/linkedin-icon-logo-png-transparent.png" alt="linkedin icon" title="linkedin profile">
                    </a>
                </div>
            </div>

        </div>
    </div>

    <div id="blankPage" style="display: none;">
        <button id="continueButton">Continuar Historia</button>

        <div id="recop">
            <button class="change" onclick="showPreviousProject()" style="left: 5px;"><</button>

            <div id="proj-content" onmouseleave="onMouse(false)">
                <div id="onMouse">
                    <h4 id="name" style="font-size: 20px;"></h4>
                    <img id="img-proj" alt="Project Image" onmouseover="onMouse(true)">
                </div>
                
                <div id="flex" style="display: none;">
                    <p id="descript" style="font-size: 18px;"></p>
                    <a id="link-proj" target="_blank">Show me this project</a>
                </div>
            </div>

            <button class="change" onclick="showNextProject()" style="right: 5px;">></button>
        </div>
    </div>
    </div>

    <script>
        const firstLine = document.getElementById("firstLine");
        const gatoBubbleStart = document.getElementById('gatoBubbleStart');
        const gatoTextStart = document.getElementById('gatoTextStart');
        const gatoImgStart = document.getElementById('gatoImgStart');
        const gatoBubble = document.getElementById('gatoBubble');
        const ninaBubble = document.getElementById('ninaBubble');
        const gatoText = document.getElementById('gatoText');
        const ninaText = document.getElementById('ninaText');
        const gatoImg = document.getElementById('gatoImg');
        const ninaImg = document.getElementById('ninaImg');
        const newPage = document.getElementById('newPage');
        const blankPage = document.getElementById('blankPage');
        const continueButton = document.getElementById('continueButton');
        const finalPage = document.getElementById('finalPage');
        const gatoBubbleNew = document.getElementById('gatoBubbleNew');
        const gatoTextNew = document.getElementById('gatoTextNew');
        const gatoImgNew = document.getElementById('gatoImgNew');
        const finalBubble = document.getElementById('finalBubble');
        const finalText = document.getElementById('finalText');
        const gatoImgFinal = document.getElementById('gatoImgFinal');
        const ninaImgFinal = document.getElementById('ninaImgFinal');
        const name = document.getElementById("name");
        const imgProj = document.getElementById("img-proj");
        const descript = document.getElementById("descript");
        const linkProj = document.getElementById("link-proj");
        const optional = document.getElementById("optional");
        const gatoBubbleOpt = document.getElementById('gatoBubbleOpt');
        const gatoTextOpt = document.getElementById('gatoTextOpt');
        const gatoImgOpt = document.getElementById('gatoImgOpt');
        const gatoImgInside = document.getElementById('gatoImgInside');
        const gatoBubbleInside = document.getElementById('gatoBubbleInside');
        const gatoTextinside = document.getElementById('gatoTextinside');
        const contact = document.getElementById('contact');


        const backgrounds = {
            game: 'https://rony260519.github.io/silver-dollop/inside.png',
            dialogue: 'https://rony260519.github.io/silver-dollop/danyplanet.jpeg',
            final: 'https://rony260519.github.io/silver-dollop/repofound.jpeg'
        };

        function updateBackground(page) {
            document.body.style.backgroundImage = `url('${backgrounds[page]}')`;
        }

        function joinMission(join) {
            options.style.display = 'none';
            if (join) {
                typeText(gatoTextStart, '¡Genial! Vamos a comenzar nuestra aventura.', () => {
                    setTimeout(() => {
                        firstLine.style.display = "none";
                        game.style.display = "block";
                        updateBackground('game');
                    }, 2000);
                });
            } else {
                typeText(gatoTextStart, 'Entiendo, entonces pasemos a los proyectos de una vez!', () => {
                    setTimeout(() => {
                        firstLine.style.display = "none";
                        blankPage.style.display = "block";
                        blankPage.removeChild(continueButton);

                    }, 2000);
                });
            }
        }

        function typeText(element, text, callback) {
            let i = 0;
            function typeWriter() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(typeWriter, 50);
                } else if (callback) {
                    callback();
                }
            }
            element.textContent = '';
            typeWriter();
        }

        window.onload = function() {
            gatoImgStart.style.display = 'block';
            gatoBubbleStart.style.display = 'block';
            typeText(gatoTextStart, "Hola, soy el Capitán Gato. Bienvenido tripulante, ¿quieres unirte a la misión?", () => {
                options.style.display = 'flex';
            });
        };







function onDialogueInside() {
    const codes = ["1", "2", "3", "4", "5", "6", "7", "8", "9"];
    
    // Mostrar el diálogo inicial del gato solo una vez
    TextCatInside();
    
    codes.map(code => {
        const buttonAnswer = document.createElement('button');
        buttonAnswer.className = "btn-answer";
        buttonAnswer.textContent = code;
        buttonAnswer.addEventListener('click', () => {
            if (code === "5") {
                typeText(gatoTextinside, '¡Genial! Hemos arrancado.', () => {
                    setTimeout(() => {
                        dialoguePlanet.style.display = 'block';
                        game.style.display = 'none';
                        updateBackground('dialogue');
                    }, 2000);
                });
            } else {
                typeText(gatoTextinside, 'Intenta otra vez, recuerda cuanto es 4 + 1');
            }
        });
        codeScreen.appendChild(buttonAnswer);
    });

    // Función para escribir texto con efecto de tipeo
    function typeText(element, text, callback) {
        let i = 0;
        function typeWriter() {
            if (i < text.length) {
                element.textContent += text.charAt(i);
                i++;
                setTimeout(typeWriter, 50);
            } else if (callback) {
                callback();
            }
        }
        element.textContent = '';  // Limpiar el texto antes de escribir
        typeWriter();
    }

    // Mostrar el diálogo inicial del gato solo una vez
    function TextCatInside() {
        gatoImgInside.style.display = 'block';
        gatoBubbleInside.style.display = 'block';
        typeText(gatoTextinside, 'Rápido, debemos arrancar, el código es 4^2 - 1');
    }
}

const observerInside = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
        if (mutation.attributeName === "style") {
            const display = window.getComputedStyle(mutation.target).display;
            if (display === "block") {
                onDialogueInside();
            }
        }
    });
});

// Configurar el observador para observar cambios en los atributos de game
observerInside.observe(game, { attributes: true });









        const obj = {
            h1: [
                "Survey Form",
                "Tribute Page",
                "Technical Documentation Page",
                "Product Landing Page",
                "Snake"
            ],

            src: [
                "https://rony260519.github.io/silver-dollop/proj-4.png",
                "https://rony260519.github.io/silver-dollop/proj-3.png",
                "https://rony260519.github.io/silver-dollop/proj-2.png",
                "https://rony260519.github.io/silver-dollop/proj-1.png",
                "https://rony260519.github.io/silver-dollop/snake.png"
            ],

            alt: [
                "Survey Form",
                "Tribute Page",
                "Technical Documentation Page",
                "Product Landing Page",
                "Snake"
            ],

            text: [
                "This project is a survey, 100% HTML and CSS, it is about a supposed website that needs to know the opinion of its users and how to improve its website.",
                "Do you know Marie Curie? She was a key link in the history of Physics, this project attempts to summarize her professional life a little.",
                "Sometimes it is somewhat complicated to learn a programming language or markup language (HTML), which is why this technical documentation page tries to compile the fundamentals to learn HTML and CSS from 0% through basic concepts and examples.",
                "One of my most recent projects is this Amazon model, which although it does not work yet, I am working to improve it, thus making it operable, but only for study purposes.",
                "Just available for PC, this funny game help me to improve my skills with HTML, CSS and JavaScript."
            ],

            href: [
                "https://dany260519.github.io/prog-1/",
                "https://dany260519.github.io/prog-2/",
                "https://dany260519.github.io/prog-3/",
                "https://dany260519.github.io/prog-4/",
                "https://dany260519.github.io/snake/"
            ]
        };

        let currentIndex = 0;

        function displayProject(index) {
            name.textContent = obj.h1[index];
            imgProj.src = obj.src[index];
            imgProj.alt = obj.alt[index];
            descript.textContent = obj.text[index];
            linkProj.href = obj.href[index];
        }

        function showNextProject() {
            currentIndex = (currentIndex + 1) % obj.h1.length;
            displayProject(currentIndex);
        }

        function showPreviousProject() {
            currentIndex = (currentIndex - 1 + obj.h1.length) % obj.h1.length;
            displayProject(currentIndex);
        }

        displayProject(currentIndex);

   
        function onMouse(show) {
            const onmouse = document.getElementById("onMouse");
            const flex = document.getElementById("flex");

            if (show) {
                flex.style.display = "block";
                onmouse.style.display = "none";
            } else {
                flex.style.display = "none";
                onmouse.style.display = "block";
            }
        }




function onDialoguePlanetShow() {
        const startDialogue = [
            { speaker: 'gato', text: 'Mira, he encontrado algo, parecen ser los proyectos de Dany...' },
            { speaker: 'gato', text: '¡Echemosle un vistazo!' }
        ];

        const dialogue = [
            { speaker: 'gato', text: 'Parece que hemos aterrizado en un planeta algo peculiar, no veo a nadie por aquí...' },
            { speaker: 'nina', text: '¡Hola!' },
            { speaker: 'gato', text: '¡Vaya! Qué susto, hola, ¿quién eres?, eres la única por aquí?' },
            { speaker: 'nina', text: 'Jaja, disculpa si te asusté, sí, lo soy... mi nombre es Dany, soy una web developer, bienvenido al planeta Portafolio.' },
            { speaker: 'gato', text: 'Mucho gusto Dany, soy el Capitán Gato y él es mi tripulante. Andamos en busca de aventuras inolvidables, ¿crees que podamos explorar tu planeta?' },
            { speaker: 'nina', text: '¡Claro! Quizás podrían ayudarme a encontrar mis proyectos. Deben verlos, aunque no son grandes aún, he mejorado mucho.' },
            { speaker: 'gato', text: '¡Claro que sí! Vamos.' }
        ];

        const newDialogue = [
            { speaker: 'gato', text: 'Mira, he encontrado algo, parecen ser los proyectos de Dany...' },
            { speaker: 'gato', text: '¡Echemosle un vistazo!' }
        ];

        const finalDialogue = [
            { speaker: 'nina', text: '¡Wow, han encontrado mis proyectos perdidos, gracias!' },
            { speaker: 'gato', text: 'De nada!' },
            { speaker: 'nina', text: '¿Qué les ha parecido?' },
            { speaker: 'gato', text: 'No están mal, quizás un día llegues a ser de los mejores...' },
            { speaker: 'gato', text: 'Creo que debemos irnos ya, gracias por recibirnos en tu planeta.' },
            { speaker: 'nina', text: 'Por nada, fue divertido jajaja, ¡hasta pronto!' },
            { speaker: 'nina', text: 'Si desean contactarme pueden hacerlo, aqui les dejo como:'}
        ];

        let currentDialogueIndex = 0;
        let charIndex = 0;

        function typeText(element, text, callback) {
            if (charIndex < text.length) {
                element.textContent += text.charAt(charIndex);
                charIndex++;
                setTimeout(() => typeText(element, text, callback), 50);
            } else {
                setTimeout(callback, 500); // Wait before showing the next bubble
            }
        }

        function showDialogue(dialogue, elements, onComplete) {
            if (currentDialogueIndex < dialogue.length) {
                const { speaker, text } = dialogue[currentDialogueIndex];
                const { bubble, textElement, img } = elements[speaker];
                
                Object.values(elements).forEach(el => {
                    el.bubble.style.display = 'none';
                    el.img.style.display = 'none';
                });

                bubble.style.display = 'block';
                img.style.display = 'block';
                textElement.textContent = '';
                charIndex = 0;
                typeText(textElement, text, () => {
                    currentDialogueIndex++;
                    showDialogue(dialogue, elements, onComplete);
                });
            } else {
                onComplete();
            }
        }

        function startNewPage() {
            document.getElementById('dialogue').style.display = 'none'; // Hide the original dialogue
            updateBackground('final');
            newPage.style.display = 'block'; // Show the new page
            currentDialogueIndex = 0; // Reset the dialogue index
            const elements = {
                gato: { bubble: gatoBubbleNew, textElement: gatoTextNew, img: gatoImgNew }
            };
            showDialogue(newDialogue, elements, () => {
                newPage.style.display = 'none';
                blankPage.style.display = 'block';
            });
        }

        function startFinalPage() {
            finalPage.style.display = 'block';
            currentDialogueIndex = 0; // Reset the dialogue index
            const elements = {
                gato: { bubble: finalBubble, textElement: finalText, img: gatoImgFinal },
                nina: { bubble: finalBubble, textElement: finalText, img: ninaImgFinal }
            };
            showDialogue(finalDialogue, elements, () => {contact.style.display = "block";});
        }

        function startInitialDialogue() {
            const elements = {
                gato: { bubble: gatoBubble, textElement: gatoText, img: gatoImg },
                nina: { bubble: ninaBubble, textElement: ninaText, img: ninaImg }
            };
            showDialogue(dialogue, elements, startNewPage);
        }

        continueButton.addEventListener('click', () => {
            blankPage.style.display = 'none';
            startFinalPage();
        });

        startInitialDialogue();
}

// Crear un observador de mutaciones para detectar cambios en el estilo de display
const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
        if (mutation.attributeName === "style") {
            const display = window.getComputedStyle(mutation.target).display;
            if (display === "block") {
                onDialoguePlanetShow();
            }
        }
    });
});

// Configurar el observador para observar cambios en los atributos de dialoguePlanet
observer.observe(dialoguePlanet, { attributes: true });



    </script>
</body>
</html>
